<!doctype html>
<html>
<head>
    <link rel='shortcut icon' href='https://amicitia.github.io/images/favicon.png' type='image/x-icon' />
    <meta charset="utf-8">
    <title>Amicitia Mods</title>
    <script src="https://amicitia.github.io/js/jquery-3.3.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
    <script data-ad-client="ca-pub-9519592525056753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link href="https://amicitia.github.io/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="https://amicitia.github.io/css/amicitia.css" rel="stylesheet" type="text/css">
    <script src="https://amicitia.github.io/js/bubbles.js"></script>
    <script src="https://amicitia.github.io/js/clipboard.js"></script>
    <script src="https://amicitia.github.io/js/showhide.js"></script>
    <script src="https://amicitia.github.io/js/hidenav.js"></script>
    <script src="https://amicitia.github.io/js/navigation.js"></script>
</head>
<body>
    <!--Copied Message-->
    <div class="copied">Copied to Clipboard</div>
    <div class="flex">
        <!--TopRow-->
        <div class="row top">
            <!--Navbar-->
            <div class="navbar">
                <div class="navbar-container">
                    <table>
                        <tr>
                            <td>
                                <a href="https://amicitia.github.io">
                                    <div class="navbar-item" style="border-bottom: 8px solid rgba(var(--text), var(--opaque));">
                                        <div class="amicitia-logo">
                                            <div class="amicitia-svg"></div>
                                        </div>Mods
                                    </div>
                                </a>
                                <!--Top Navbar-->
                                <a href="https://shrinefox.com/news">
                                    <div class="navbar-item">
                                        <span><i class="fa fa-newspaper"></i>&nbsp;News</span>
                                    </div>
                                </a>
                                <a href="https://shrinefox.com/guides">
                                    <div class="navbar-item">
                                        <span><i class="fa fa-graduation-cap"></i>&nbsp;Guides</span>
                                    </div>
                                </a>
                                <a href="https://shrinefox.com/blog">
                                    <div class="navbar-item">
                                        <span><i class="fab fa-wordpress"></i>&nbsp;Blog</span>
                                    </div>
                                </a>
                            </td>
                            <td id="sidebartoggle">
                                <label for="openSidebarMenu" class="sidebarIconToggle">
                                    <div class="spinner diagonal part-1"></div>
                                    <div class="spinner horizontal"></div>
                                    <div class="spinner diagonal part-2"></div>
                                </label>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <!--Sidebar Toggle-->
            <input type="checkbox" class="openSidebarMenu" id="openSidebarMenu" style="position: fixed;display:none;">
            <aside class="sidebar">
                <div class="component">
                    <div class="contents">
                        <ul class="items list">
                            <!--Sidebar Items-->
                            <div class="sidebarheader">
                                <h4><i class="fa fa-users"></i> &nbsp;&nbsp;Forum</h4>
                            </div>
                            <a href="https://shrinefox.com/forum/ucp.php">
                                <div class="item">
                                    <i class="fa fa-address-card"></i> &nbsp;Account Settings
                                </div>
                            </a>
                            <a href="https://shrinefox.com/forum/ucp.php?i=pm&folder=inbox">
                                <div class="item">
                                    <i class="fa fa-envelope"></i> &nbsp;Inbox
                                </div>
                            </a>
                            <a href="https://shrinefox.com/forum/search.php">
                                <div class="item">
                                    <i class="fa fa-search"></i> &nbsp;Search
                                </div>
                            </a>
                            <a href="https://shrinefox.com/forum/search.php?search_id=egosearch">
                                <div class="item">
                                    <i class="fa fa-sticky-note"></i> &nbsp;Your Posts
                                </div>
                            </a>
                            <a href="https://shrinefox.com/forum/search.php?search_id=active_topics">
                                <div class="item">
                                    <i class="fa fa-star"></i> &nbsp;Active Threads
                                </div>
                            </a>
                            <div class="sidebarheader">
                                <h4><i class="fa fa-cube"></i> &nbsp;&nbsp;Resources</h4>
                            </div>
                            <a href="https://amicitia.miraheze.org/wiki/Main_Page">
                                <div class="item">
                                    <i class="fa fa-book"></i> &nbsp;Wiki
                                </div>
                            </a>
                            <a href="https://shrinefox.com/forum/app.php/faqpage">
                                <div class="item">
                                    <i class="fa fa-question-circle"></i> &nbsp;FAQs
                                </div>
                            </a>
                            <div class="sidebarheader">
                                <h4><i class="fa fa-terminal"></i>&nbsp;&nbsp;Apps</h4>
                            </div>
                            <a href="https://shrinefox.com/PatchCreator">
                                <div class="item">
                                    <i class="fa fa-check-square"></i> &nbsp;P5 RPCS3 Patch.yml Creator
                                </div>
                            </a>
                            <a href="https://shrinefox.com/textsearch">
                                <div class="item">
                                    <i class="fab fa-searchengin"></i> &nbsp;Dialog Search
                                </div>
                            </a>
                            <a href="https://amicitia.github.io/files">
                                <div class="item">
                                    <i class="fa fa-folder-open"></i> &nbsp;Dumps
                                </div>
                            </a>
                            <a href="https://amicitia.github.io/docs/flowscript">
                                <div class="item">
                                    <i class="fa fa-file-code"></i> &nbsp;Flowscript Docs
                                </div>
                            </a>
                        </ul>
                    </div> <!--End Contents-->
                </div>  <!--End Component-->
            </aside>  <!--End Sidebar Menu-->
            <!--Header-->
            <div class="header">
                <canvas id="bgCanvas" width="715" height="722" style=""></canvas>
                <div class="header-inner" style="margin-top: 150px;">
                    <center>
                        <!--Title-->
                        <div class="headerselect">
                            <!--Game Select required for bubbles.js themeing-->
                            <select id="game" name="game" onchange="navigate()">
                                <option value="all">Game</option>
                                <option value="P5">Persona 5</option>
                                <option value="P5R">Persona 5 Royal</option>
                                <option value="P5S">Persona 5 Strikers</option>
                                <option value="P5D">Persona 5 Dancing in Starlight</option>
                                <option value="P4">Persona 4</option>
                                <option value="P4G">Persona 4 Golden</option>
                                <option value="P4AU">Persona 4 Arena Ultimax</option>
                                <option value="P4D">Persona 4 Dancing All Night</option>
                                <option value="P3FES">Persona 3 FES</option>
                                <option value="P3P">Persona 3 Portable</option>
                                <option value="P3D">Persona 3 Dancing in Moonlight</option>
                                <option value="PQ">Persona Q</option>
                                <option value="PQ2">Persona Q2</option>
                                <option value="CFB">Catherine Full Body</option>
                                <option value="SMT3">Shin Megami Tensei Nocturne</option>
                            </select>
                        </div>
                        <div class="subheaderselect">
                            <!--Select serving as website navigation-->
                            <select id="type" name="type" onchange="navigate()">
                                <option value="all">Modding Resources</option>
                                <option value="mods">Mods</option>
                                <option value="tools">Tools</option>
                                <option value="cheats">Cheats</option>
                                <option value="guides">Guides</option>
                            </select>
                        </div>
                    </center>
                    <!--Waves-->
                    <div>
                        <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                            <defs>
                                <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
                            </defs>
                            <g class="parallax">
                                <use xlink:href="#gentle-wave" x="48" y="0"></use>
                                <use xlink:href="#gentle-wave" x="48" y="3"></use>
                                <use xlink:href="#gentle-wave" x="48" y="5"></use>
                                <use xlink:href="#gentle-wave" x="48" y="7"></use>
                            </g>
                        </svg>
                    </div>
                    <!--Waves End-->
                </div>
                <!--Header End-->
            </div>
            <!--Navbar End-->
        </div>
        <!--Top End-->
<!--Middle-->
<div class="row middle">
    <!--Page Body-->
    <div class="content">
        <table>
            <!--Sidebar-->
            <tr>
                <td style="vertical-align:top;">
                    <div class="bloglinks">
                        <div class="blogtype">
                            <table>
                                <tr>
                                    <td>
                                        <a href="https://shrinefox.com/news/">
                                            <h4>
                                                <i class="fas fa-newspaper"></i> News
                                            </h4>
                                        </a>
                                    </td>
                                    <td class="blogdate">
                                        Dec 20
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="blogdivider"></div>
                        <h4 style="margin-left: 10px;">
                            <a href="https://amicitia-team.tumblr.com/post/638012597777629184">Modding Support for P5R USA!</a>
                        </h4>
                        <br>
                        <div class="blogtype">
                            <table>
                                <tr>
                                    <td>
                                        <a href="https://shrinefox.com/guides/">
                                            <h4>
                                                <i class="fas fa-graduation-cap"></i> Guides
                                            </h4>
                                        </a>
                                    </td>
                                    <td class="blogdate">
                                        Jan 21
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="blogdivider"></div>
                        <h4 style="margin-left: 10px;">
                            <a href="https://shrinefox.com/guides/2020/09/30/modding-persona-5-royal-jp-on-ps4-fw-6-72/">Modding P5R USA on PS4 FW 5.05 - 6.72</a>
                        </h4>
                    </div>
                </td>
                <td id="main"><div class="container body-content">
	<table>
        <tr>
            <td width="25%" style="vertical-align:top">
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td style="width: 75%; padding-right:20px; vertical-align: top;">
				<div class="content-outer">
					<div class="content">
						<h1>Messagescript</h1><i>Flowscript</i> doesn't support <a href="https://techterms.com/definition/string">strings</a> as a variable type, but it's possible to display text in the form of dialog and selectable options by referencing a <b>messagescript</b> file.
						<h2>Creating a Messagescript</h2>
						Messagescripts are text files ending with the extension .<b>msg</b>, often accompanying a .<i>flow</i> (<i>flowscript</i>). Simply create a new text file and rename the extension. You may need to <a href="https://www.howtogeek.com/205086/beginner-how-to-make-windows-show-file-extensions/">make Windows display known file extensions</a> in order to change .txt to .msg.
						<br>Below is a sample from a <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg">custom messagescript</a>.
<pre><code class="c#">[dlg BossRushModeDialog [TGE]]
[f 2 1]Select a boss fight.[f 1 1][e]

[sel SelectBoss0]
[f 2 1]D00_SCENARIO_BATTLE_01[e]
[f 2 1]D01_01_SCENARIO_BATTLE_01[e]
[f 2 1]D01_01_MORUGANA_BATTLE[e]
[f 2 1]D01_02_SCENARIO_BATTLE_01[e]
[f 2 1]Previous[e]
[f 2 1]Next[e]
</code></pre>
						<br>There are <b>two types</b> of message declarations: <b>dialog</b> and <b>selection</b>.
						<br>Brackets that start with <b>dlg</b> or <b>msg</b>...
						<ul>
							<li>Can be used for dialog boxes, window labels etc.
							<li>Have a unique name (i.e. <b>BossRushModeDialog</b> )
							<li>Can have an optional nametag in brackets (i.e. <b>[TGE]</b> )
							<li>Have a message on the next new line, starting with <b>[s]</b>/<b>[f 2 1]</b> and ending with <b>[e]</b>.
							<li>Can have multiple messages on new lines as long as they come before the next message declaration.
						</ul>
						<br>Brackets that start with <b>sel</b>...
						<ul>
							<li>Can be used for menu options.
							<li>Have a unique name (i.e. <b>SelectBoss0</b> )
							<li>Have a message on the next new line, starting with <b>[s]</b>/<b>[f 2 1]</b> and ending with <b>[e]</b>.
							<li>Can have multiple messages on new lines as long as they come before the next message declaration.
						</ul>
						<a href="https://youtu.be/fTUIyUgc04U?t=237"><img src="https://i.imgur.com/Q3AkSbO.png"></a>
						<h2>Using Markup</h2>
						You can change the appearance of text by inserting the following codes (in brackets) into your message.
						<ul>
							<li>[<b>clr</b> x] Text color. x is a number <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Documents/RE/MessageScriptInterpreter.cpp#L28">between 0 and 30</a>. Affects all text after the tag until the end of the line ([e]).
							<li>[<b>n</b>] Linebreak. Put this between some text to make it show up on a new line ingame.
							<li>[<b>w</b>] Wait. Makes the game await user input before moving on to the next line.
							<li>[<b>vp</b> w x y z 0 0] Voice Pack. Makes the game play a voice clip. <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptLibrary/Libraries/Persona5/MessageScriptLibrary.json#L233">w = eventIdMajor, x = eventIdMinor, y = eventIdSub, z = cueId</a>.
							<li>[<b>bup</b> 0 x y z 0] Bustup. Shows a character's talking sprite during dialog. <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptLibrary/Libraries/Persona5/MessageScriptLibrary.json#L314">x = characterId, y = expressionId, z = customeId</a>. Lip flap will animate if followed by [f 4 10 -1 0 0].
						</ul>
						<h2>Referencing Messages in Flowscripts</h2>
						By <a href="https://amicitia.github.io/docs/importing">importing the messagescript into the flowscript</a>, you can reference messages in two ways: by <b>ID</b> or by the message's <b>unique name</b>.
						For instance, here's an example of a dialog box that references the messagescript sample above.
<pre><code class="c#">import( "TestScript2.msg" );

void StartBossrushMode()
{
	// Display the dialog window
	MSG_WND_DSP(); 
	// Display dialog
	MSG( BossRushModeDialog, 0 );
	// Close the dialog window
	MSG_WND_CLS(); 	
}</pre></code>
						<b>MSG(BossRushModeDialog, 0)</b> actually yeilds the same results as <b>MSG(5, 0)</b> since (counting up from 0) BossRushModeDialog is the fifth selection or dialog message with a unique name in the <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg#L31">msg file</a>.
						Here's an example of a selection that returns an integer (the index of the string from the referenced [sel] message).
<pre><code class="c#">// Display dialog window
MSG_WND_DSP(); 
MSG( HelloDialog, 0 ); 
// Display selection options while dialog is still shown
int selection = SEL( 1 );
MSG_WND_CLS();</pre></code>
						<b>SEL(1)</b> in this case refers to <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg#L4">this message in the messagescript file</a>. You can use the value it returns to decide what to do with the selected option in-game:
<pre><code class="c#">
switch ( selection )
{
	case 0:
		int playerResHandle = FLD_PC_GET_RESHND( 0 );		
		FLD_MODEL_SET_SCALE( playerResHandle, 2f );
		break;
	case 1:
		CALL_FIELD( 0, 2, 0, 0 );
		break;
	case 2:
		StartBossrushMode();
		break;
	case 3:
		StartTeleportMode();
		break;
	case 4:
		StartButtonTestMode();
		break;
	case 5:
		StartSoundTestMode();
		break;
	default:
		break;
}</pre></code>
					</div>
				</div>
			</td>
		</tr>
	</table>
</div>                    </div>
                <!--Pagination--><br>
                </td></tr></tbody></table>
                <!--Footer-->
                <div class="row bottom">
                    <footer>
                        <table style="padding-right: 2%;">
                            <tbody>
                                <tr>
                                    <td style="vertical-align: top;width: 25%;">
                                        <center>
                                            <img src="https://pbs.twimg.com/profile_images/1347312450895572993/ZfHnzfcq_400x400.jpg" style="clip-path: circle(39px at center);width: 75px;">
                                        </center>
                                        <br>
                                        <a href="https://shrinefox.com/">ShrineFox</a> is passionate about customizing games, consoles and devices. This site is a resource for learning the latest available techniques.
                                        <br><br><a href="https://shrinefox.com/credits"><i class="fa fa-heart"></i> <b>Site Credits</b></a>
                                    </td>
                                    <td style="vertical-align: top;width: 20%;padding-left: 20px;">
                                        <br><a href="https://www.youtube.com/c/ShrineFox"><i class="fa fa-youtube"></i> <b>YouTube</b></a>
                                        <br><br><a href="https://twitter.com/ShrineFoxMods"><i class="fa fa-twitter"></i> <b>ShrineFox</b></a>
                                        <br><br><a href="https://twitter.com/AmicitiaTeam"><i class="fa fa-twitter"></i> <b>AmicitiaTeam</b></a>
                                        <br><br><a href="https://reddit.com/r/Amicitia"><i class="fa fa-reddit"></i> <b>Reddit</b></a>
                                        <br><br><a href="https://discord.gg/9USHGmB"><i class="fab fa-discord"></i> <b>Discord</b></a>
                                    </td>
                                    <td width="5%"></td>
                                    <td>
                                        We are NOT affiliated, associated, authorized, endorsed by, or in any way
                                        officially connected with ATLUS, SEGA, or any of its subsidiaries or its affiliates.
                                        The official ATLUS website can be found at <a href="https://atlus.com/">https://atlus.com</a>. ATLUS and SEGA are
                                        registered in the U.S. Patent and Trademark Office. ATLUS and PERSONA are
                                        either registered trademarks or trademarks of ATLUS Co., Ltd. or its affiliates.
                                        <!--Theme Select required for bubbles.js themeing-->
                                        <br>Theme: <select id="theme" name="theme" onchange="ThemeToggle()">
                                            <option value="" selected>Default</option>
                                            <option value="p5">Red/Black</option>
                                            <option value="p4">Yellow/Orange</option>
                                            <option value="p3fes">Green/Blue</option>
                                            <option value="pq">Pink/Purple</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                        <!--Bubble Popping SFX Toggle-->
                                        <br>Sound: <i id="sound" class="fas fa-volume-mute" onclick="SoundToggle()"></i>
                                        <!--Performance Mode Toggle-->
                                        <br>Performance Mode: <i id="performance" class="fas fa-toggle-off" onclick="PerformanceToggle()"></i>
                                        <!--Score Display-->
                                        <br><span id="score">0</span> bubbles popped
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <center>
                            <!--AdSense-->
                            <br>
                            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-hx+4+s-4m+70" data-ad-client="ca-pub-9519592525056753" data-ad-slot="8263745709"></ins>
                            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                            <br>
                            <!--Credits-->
                            <br>© ShrineFox 2020 - 2021. <a href="https://ko-fi.com/shrinefox"><i class="fa fa-coffee"></i> Support</a>
                            <br><br>
                            <!--Placeholder-->
                            <select id="game" name="game" style="display:none;">
                                <option value="" selected>Default</option>
                            </select>
                        </center>
                        <!--End Footer-->
                    </footer>
                </div>
                <!--End Bottom-->
		     </div>
		</form>
	</body>
</html>