<script src="https://amicitia.github.io/js/jquery-3.3.1.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
<script data-ad-client="ca-pub-9519592525056753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link href="https://amicitia.github.io/favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="https://amicitia.github.io/css/amicitia.css" rel="stylesheet" type="text/css">
<script src="https://amicitia.github.io/js/bubbles.js"></script>
<script src="https://amicitia.github.io/js/clipboard.js"></script>
<script src="https://amicitia.github.io/js/showhide.js"></script>
<script src="https://amicitia.github.io/js/navigation.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/FeedEk.min.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/jscolor.js"></script>
<link rel="stylesheet" href="https://amicitia.github.io/css/css3menu.css" type="text/css" />
<style type="text/css">._css3m {display: none;}</style>				</td>
				<!--Sidebar-->
                <td style="vertical-align:top;width:20%;text-align:right;font-size:10pt;" class="bloglinks">
					<b>LATEST UPDATES</b>
                    <div id="news-feed"></div>
                    <div id="guides-feed"></div>
                    <div id="blog-feed"></div>
                    <script>
						$('#news-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/news/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});

						$('#guides-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/guides/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});

						$('#blog-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/blog/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});
                    </script><div class="container body-content">
	<table>
        <tr>
            <td width="25%" style="vertical-align:top">
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td style="width: 75%; padding-right:20px; vertical-align: top;">
				<div class="content-outer">
					<div class="content">
						<h1>Messagescript</h1><i>Flowscript</i> doesn't support <a href="https://techterms.com/definition/string">strings</a> as a variable type, but it's possible to display text in the form of dialog and selectable options by referencing a <b>messagescript</b> file.
						<h2>Creating a Messagescript</h2>
						Messagescripts are text files ending with the extension .<b>msg</b>, often accompanying a .<i>flow</i> (<i>flowscript</i>). Simply create a new text file and rename the extension. You may need to <a href="https://www.howtogeek.com/205086/beginner-how-to-make-windows-show-file-extensions/">make Windows display known file extensions</a> in order to change .txt to .msg.
						<br>Below is a sample from a <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg">custom messagescript</a>.
<pre><code class="c#">[dlg BossRushModeDialog [TGE]]
[f 2 1]Select a boss fight.[f 1 1][e]

[sel SelectBoss0]
[f 2 1]D00_SCENARIO_BATTLE_01[e]
[f 2 1]D01_01_SCENARIO_BATTLE_01[e]
[f 2 1]D01_01_MORUGANA_BATTLE[e]
[f 2 1]D01_02_SCENARIO_BATTLE_01[e]
[f 2 1]Previous[e]
[f 2 1]Next[e]
</code></pre>
						<br>There are <b>two types</b> of message declarations: <b>dialog</b> and <b>selection</b>.
						<br>Brackets that start with <b>dlg</b> or <b>msg</b>...
						<ul>
							<li>Can be used for dialog boxes, window labels etc.
							<li>Have a unique name (i.e. <b>BossRushModeDialog</b> )
							<li>Can have an optional nametag in brackets (i.e. <b>[TGE]</b> )
							<li>Have a message on the next new line, starting with <b>[s]</b>/<b>[f 2 1]</b> and ending with <b>[e]</b>.
							<li>Can have multiple messages on new lines as long as they come before the next message declaration.
						</ul>
						<br>Brackets that start with <b>sel</b>...
						<ul>
							<li>Can be used for menu options.
							<li>Have a unique name (i.e. <b>SelectBoss0</b> )
							<li>Have a message on the next new line, starting with <b>[s]</b>/<b>[f 2 1]</b> and ending with <b>[e]</b>.
							<li>Can have multiple messages on new lines as long as they come before the next message declaration.
						</ul>
						<a href="https://youtu.be/fTUIyUgc04U?t=237"><img src="https://i.imgur.com/Q3AkSbO.png"></a>
						<h2>Using Markup</h2>
						You can change the appearance of text by inserting the following codes (in brackets) into your message.
						<ul>
							<li>[<b>clr</b> x] Text color. x is a number <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Documents/RE/MessageScriptInterpreter.cpp#L28">between 0 and 30</a>. Affects all text after the tag until the end of the line ([e]).
							<li>[<b>n</b>] Linebreak. Put this between some text to make it show up on a new line ingame.
							<li>[<b>w</b>] Wait. Makes the game await user input before moving on to the next line.
							<li>[<b>vp</b> w x y z 0 0] Voice Pack. Makes the game play a voice clip. <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptLibrary/Libraries/Persona5/MessageScriptLibrary.json#L233">w = eventIdMajor, x = eventIdMinor, y = eventIdSub, z = cueId</a>.
							<li>[<b>bup</b> 0 x y z 0] Bustup. Shows a character's talking sprite during dialog. <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptLibrary/Libraries/Persona5/MessageScriptLibrary.json#L314">x = characterId, y = expressionId, z = customeId</a>. Lip flap will animate if followed by [f 4 10 -1 0 0].
						</ul>
						<h2>Referencing Messages in Flowscripts</h2>
						By <a href="https://amicitia.github.io/docs/importing">importing the messagescript into the flowscript</a>, you can reference messages in two ways: by <b>ID</b> or by the message's <b>unique name</b>.
						For instance, here's an example of a dialog box that references the messagescript sample above.
<pre><code class="c#">import( "TestScript2.msg" );

void StartBossrushMode()
{
	// Display the dialog window
	MSG_WND_DSP(); 
	// Display dialog
	MSG( BossRushModeDialog, 0 );
	// Close the dialog window
	MSG_WND_CLS(); 	
}</pre></code>
						<b>MSG(BossRushModeDialog, 0)</b> actually yeilds the same results as <b>MSG(5, 0)</b> since (counting up from 0) BossRushModeDialog is the fifth selection or dialog message with a unique name in the <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg#L31">msg file</a>.
						Here's an example of a selection that returns an integer (the index of the string from the referenced [sel] message).
<pre><code class="c#">// Display dialog window
MSG_WND_DSP(); 
MSG( HelloDialog, 0 ); 
// Display selection options while dialog is still shown
int selection = SEL( 1 );
MSG_WND_CLS();</pre></code>
						<b>SEL(1)</b> in this case refers to <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/a8533ccf589953e6a75858c4bcb333a4dcdc38bc/Source/AtlusScriptCompiler/Resources/TestScript2.msg#L4">this message in the messagescript file</a>. You can use the value it returns to decide what to do with the selected option in-game:
<pre><code class="c#">
switch ( selection )
{
	case 0:
		int playerResHandle = FLD_PC_GET_RESHND( 0 );		
		FLD_MODEL_SET_SCALE( playerResHandle, 2f );
		break;
	case 1:
		CALL_FIELD( 0, 2, 0, 0 );
		break;
	case 2:
		StartBossrushMode();
		break;
	case 3:
		StartTeleportMode();
		break;
	case 4:
		StartButtonTestMode();
		break;
	case 5:
		StartSoundTestMode();
		break;
	default:
		break;
}</pre></code>
					</div>
				</div>
			</td>
		</tr>
	</table>
</div>								<!--Pagination-->
                                </td>
							</tr>
						</table>
					</div>
                </td></tr></tbody></table>
                <!--Footer-->
                <div class="row bottom">
                    <footer>
                        <table style="padding-right: 2%;">
                            <tbody>
                                <tr>
                                    <td id="about_site" style="vertical-align: top;width: 25%;">
                                        <center>
                                            <div class="amicitia-logo" style="left: auto;position: relative;width: 75px;height: 75px;float: none;">
                                                <div class="amicitia-svg" style="height: 75px; width: 75px;background: url(https://amicitia.github.io/images/logo.svg) center center/75px no-repeat;"></div>
                                            </div>
                                        </center>
                                        <br>
                                        <a href="https://shrinefox.com/amicitia">Amicitia</a> is a modding network dedicated to documenting & reverse engineering SMT/Persona games, named after <a href="https://github.com/TGEnigma">TGEnigma</a>'s all-in-one editor application <a href="https://amicitia.github.io/post/amicitia">of the same name</a>.
                                    </td>
                                    <td id="site_disclaimer" width="5%" style="vertical-align:top;"></td>
                                    <td>
                                        We are NOT affiliated, associated, authorized, endorsed by, or in any way
                                        officially connected with ATLUS, SEGA, or any of its subsidiaries or its affiliates.
                                        The official ATLUS website can be found at <a href="https://atlus.com/">https://atlus.com</a>. ATLUS and SEGA are
                                        registered in the U.S. Patent and Trademark Office. ATLUS and PERSONA are
                                        either registered trademarks or trademarks of ATLUS Co., Ltd. or its affiliates.
                                        <!--Theme Select required for bubbles.js themeing-->
                                        <table id="settings">
                                            <tr>
                                                <td style="vertical-align:top;">
                                                    <br><br>Theme: <select id="theme" name="theme" onchange="ThemeToggle()">
                                                        <option value="" selected>Default</option>
                                                        <option value="p5">Red/Black</option>
                                                        <option value="p4">Yellow/Orange</option>
                                                        <option value="p3fes">Green/Black</option>
                                                        <option value="pq">Pink/Purple</option>
                                                        <option value="custom">Custom</option>
                                                    </select>

                                                    <!--Color Picker-->
                                                    <script>
                                                        jscolor.presets.default = {
                                                            format: 'rgb', previewSize: 20, paletteCols: 1,
                                                            backgroundColor: 'rgb(var(--post))', borderColor: 'rgb(var(--post))',
                                                            padding: 5, width: 100, height: 100, mode: 'HVS',
                                                            controlBorderColor: 'rgb(var(--post))', sliderSize: 8, shadow: false
                                                        };
                                                    </script>
                                                    <div id="colorpicker" style="display:none;">
                                                        <div class="text">
                                                            <div class="toggle-title" style="cursor: pointer;" onclick="updateColorPicker()">
                                                                <a><i class="fa fa-gears"></i> Theme Settings</a>
                                                            </div>
                                                            <div class="toggle-inner" style="display:none;">
                                                                <br><button id="customlink" data-jscolor="{onChange: 'updateLink(this)',value:'rgb(var(--link))', alpha:1}">Link</button>
                                                                <br><button id="customhover" data-jscolor="{onChange: 'updateHover(this)',value:'rgb(var(--hover))', alpha:1}">Hover</button>
                                                                <br><button id="custombg" data-jscolor="{onChange: 'updateBg(this)',value:'rgb(var(--bg))', alpha:1}">Background</button>
                                                                <br><button id="custombg2" data-jscolor="{onChange: 'updateBg2(this)',value:'rgb(var(--bg2))', alpha:1}">Background 2</button>
                                                                <br><button id="customtext" data-jscolor="{onChange: 'updateText(this)',value:'rgb(var(--text))', alpha:1}">Text</button>
                                                                <br><button id="custompost" data-jscolor="{onChange: 'updatePost(this)',value:'rgb(var(--post))', alpha:1}">Post</button>
                                                                <br><button id="customtextinner" data-jscolor="{onChange: 'updateTextinner(this)',value:'rgb(var(--textinner))', alpha:1}">Inner Text</button>
                                                                <br><button id="customfooter" data-jscolor="{onChange: 'updateFooter(this)',value:'rgb(var(--footer))', alpha:1}">Footer</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:top;">
                                                    <!--Bubble Popping SFX Toggle-->
                                                    <br>Sound: <i id="sound" class="fas fa-volume-mute" onclick="SoundToggle()"></i>
                                                    <!--Performance Mode Toggle-->
                                                    <br>Performance Mode: <i id="performance" class="fas fa-toggle-off" onclick="PerformanceToggle()"></i>
                                                    <!--Score Display-->
                                                    <br><span id="score">0</span> bubbles popped
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                            </tbody>
                        </table>
                        <br>
                        <center>
                            <!--AdSense-->
                            <br>
                            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-hx+4+s-4m+70" data-ad-client="ca-pub-9519592525056753" data-ad-slot="8263745709"></ins>
                            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                            <br>
                            <!--Credits-->
                            <br>© ShrineFox 2020 - 2021. <a href="https://ko-fi.com/shrinefox"><i class="fa fa-coffee"></i> Support</a>
                            <br><br>
                            <!--Placeholder-->
                            <select id="game" name="game" style="display:none;">
                                <option value="" selected>Default</option>
                            </select>
                        </center>
                        <!--End Footer-->
                    </footer>
                </div>
                <!--End Bottom-->
		     </div>
		</form>
	</body>
</html>