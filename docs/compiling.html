<script src="https://amicitia.github.io/js/jquery-3.3.1.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
<script data-ad-client="ca-pub-9519592525056753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link href="https://amicitia.github.io/favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="https://amicitia.github.io/css/amicitia.css" rel="stylesheet" type="text/css">
<script src="https://amicitia.github.io/js/bubbles.js"></script>
<script src="https://amicitia.github.io/js/clipboard.js"></script>
<script src="https://amicitia.github.io/js/showhide.js"></script>
<script src="https://amicitia.github.io/js/navigation.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/FeedEk.min.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/jscolor.js"></script>
<link rel="stylesheet" href="https://amicitia.github.io/css/css3menu.css" type="text/css" />
<style type="text/css">._css3m {display: none;}</style>				</td>
				<!--Sidebar-->
                <td style="vertical-align:top;width:20%;text-align:right;font-size:10pt;" class="bloglinks">
					<b>LATEST UPDATES</b>
                    <div id="news-feed"></div>
                    <div id="guides-feed"></div>
                    <div id="blog-feed"></div>
                    <script>
						$('#news-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/news/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});

						$('#guides-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/guides/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});

						$('#blog-feed').FeedEk({
							FeedUrl:'https://shrinefox.com/blog/feed',
							MaxCount : 3,
							ShowDesc : false,
							ShowPubDate:true,
							DescCharacterLimit:0,
							TitleLinkTarget:'_blank',
							DateFormat: 'MMM d',
							DateFormatLang:'en'
						});
                    </script>
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td style="width: 75%; padding-right:20px; vertical-align: top;">
				<div class="content-outer">
                    <div class="content">
						<h1>Compiling</h1>
<br>Using <b>AtlusScriptCompiler</b>, you can turn <b>.flow</b> files into <b>.bf</b> files, or <b>.msg</b> files into <b>.bmd</b> files. Anything else referenced in a .flow (bf/bmd/flow/msg) also becomes part of a resulting .bf file.
<br />
<br />You can <a href="https://shrinefox.com?tool=atlusscriptcompiler">download the latest AtlusScriptCompiler here</a>.
<h2>Using Commandline Arguments</h2>
Once you have extracted the program to a folder, simply clicking on the exe causes a console window to quickly open and close. That's normal.
<br />Normally, to use AtlusScriptCompiler you have to use <i>commandline arguments</i>. If you have never used the Windows command prompt before, don't worry. It's quite simple:
<br />You can open the command prompt one of several ways:
<ul>
    <li>Searching for <b>"cmd"</b> in the Windows search bar</li>
    <li>Pressing <b>ctrl + R</b> and typing "cmd" in the Run window</li>
    <li>Typing "cmd" in the address bar in Windows explorer</li>
    <li>Right click inside a folder in Windows Explorer while holding shift and choose "Open Command Window here" (might have to <a href="https://www.windowscentral.com/add-open-command-window-here-back-context-menu-windows-10">do this first on Windows 10</a>)</li>
</ul>
Once the command prompt has opened, all you have to do is type the path to the EXE (i.e. "C:\User\Username\Desktop\AtlusScriptCompiler\AtlusScriptCompiler.exe"). It's smart to wrap the path in quotation marks in case it contains spaces.
<br />Note that you can also drag the EXE onto the command prompt window to automatically fill in the path.
<br />If you used one of the latter two methods of opening the command prompt, if the folder contains AtlusScriptCompiler.exe, all you have to type is "AtlusScriptCompiler.exe".
<br />Press enter, and the program will print information to the console without immediately closing.
<br />You can press up on the keyboard to copy what you previously typed in order to make changes.
<br />
<h3>Supplying the Input File</h3>
Whether the file you want to compile is a .msg or .flow, if you supply the path immediately after "AtlusScriptCompiler.exe" (followed by a space) it will be used as the input file.
<br>If your input is a .bf or .bmd, you may be looking for <a href="https://amicitia.github.io/docs/decompiling">instructions on <i>de</i>compiling</a> instead.
<h3>Supplying the Compile Command</h3>
Follow up the command so far with another space and then "-Compile" in order to tell the program what to do with the input file.
<h3>Supplying the Output Format</h3>
Once again, separate this next part from the previous with a space and type one of the following:
<ul>
    <li>"-OutFormat V3BE" (if your game is <b>Persona 5</b> and your desired output format is <b>.BF</b>, ideal when <b>.FLOW</b> is supplied as the input)</li>
    <li>"-OutFormat V1BE" (if your game is <b>Persona 5 (PS3)</b> and your desired output format is <b>.BMD</b>, ideal when <b>.MSG</b> is supplied as the input)</li>
    <li>"-OutFormat V1" (if your game is <b>Persona 5 (PS4) or Persona 3 or 4</b> and your desired output format is <b>.BMD</b>, ideal when <b>.MSG</b> is supplied as the input)</li>
    <li>"-OutFormat V1" (if your game is <b>Persona 3 or 4</b> and your desired output format is <b>.BF</b>, ideal when <b>.FLOW</b> is supplied as the input)</li>
</ul>
<br />For example so far, your command should look something like this:
<pre><code>"AtlusScriptCompiler.exe" "field.bf.flow" -Compile -OutFormat V3BE</code></pre>
<h3>Supplying the Library</h3>
For AtlusScriptCompiler to successfully resolve <b>.flow</b> to <b>.bf</b>, a library must exist that defines the game's functions and their parameters. In order to create a library, function signatures must be dumped from the game using <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/master/Scripts/ScriptInterpreterCOMMTableToJson_SMT.py"></a>a script like this one</a>.
<ul>
    <li>"-Library P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Library P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Library P4G" (if your game is <b>Persona 4 Golden</b>)</li>
    <li>"-Library P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Library P3F" (if your game is <b>Persona 3 FES</b>)</li>
    <li>"-Library PQ2" (if your game is <b>Persona Q2</b>)</li>
    <li>"-Library SMT3" (if your game is <b>SMT Nocturne</b>)</li>
    <li>"-Library DDS" (if your game is <b>Digital Devil Saga</b>)</li>
</ul>
<br />The script will fail to compile if the appropriate library isn't present.
<br />At the time of writing, there is no library for <b>Persona 3 Portable</b>.
<h3>Supplying the Encoding</h3>
For AtlusScriptCompiler to successfully compile to either <b>.bf</b> or <b>.bmd</b>, encoding must be specified.
<ul>
    <li>"-Encoding P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Encoding P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Encoding P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Encoding SJ" (if your game is <b>Persona Q(2)</b> or uses Shift-JIS/CP932)</li>
</ul>
<h3>Specifying the Output File</h3>
While the command so far is enough to output a file, it would be automatically named after the input. For instance, field.bf.flow would generate field.bf.flow.bf.
<br />If you would rather name it something else like field2.bf, or replace field.bf, try something like the following:
<br /><pre><code>"AtlusScriptCompiler.exe" "field.bf.flow" -Compile -OutFormat V3BE -Library P5 -Encoding P5 -Out "field.bf"</code></pre>
<br />Once again, remember to wrap paths to files in quotation marks in case they contain spaces.
<h3>Other Commands</h3>
When you run the program without specifying any commandline arguments, you will be shown a list of additional commands to use.
<br />For information on how to use the "-Hook" command, <a href="https://amicitia.github.io/docs/hookingfunctions">see this page</a>.
<h2>Using the GUI Frontend</h2>
There is an unofficial GUI for AtlusScriptCompiler that allows you to simply drag and drop files to compile or decompile them.
<br />You can get it from <a href="https://github.com/ShrineFox/AtlusScriptCompiler-GUI-Frontend/releases">here</a>. Just extract the contents of the .zip to the folder containing AtlusScriptCompiler.exe on your computer and run it.
<br />Be sure to set the proper game in the dropdown first. If no output file is produced, check the "AtlusScriptCompiler.log" file in the same directory.
<h2>Resolving Errors</h2>
If a script has failed to compile, an error message should be shown. It will usually try to show the exact line number where the error occured so you can fix it, along with a description of what's wrong.
<br />For a more visual guide on using AtlusScriptCompiler, see the video:
<br /><iframe width="560" height="315" src="https://www.youtube.com/embed/HonHDoSJNDY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>								<!--Pagination-->
                                </td>
							</tr>
						</table>
					</div>
                </td></tr></tbody></table>
                <!--Footer-->
                <div class="row bottom">
                    <footer>
                        <table style="padding-right: 2%;">
                            <tbody>
                                <tr>
                                    <td id="about_site" style="vertical-align: top;width: 25%;">
                                        <center>
                                            <div class="amicitia-logo" style="left: auto;position: relative;width: 75px;height: 75px;float: none;">
                                                <div class="amicitia-svg" style="height: 75px; width: 75px;background: url(https://amicitia.github.io/images/logo.svg) center center/75px no-repeat;"></div>
                                            </div>
                                        </center>
                                        <br>
                                        <a href="https://shrinefox.com/amicitia">Amicitia</a> is a modding network dedicated to documenting & reverse engineering SMT/Persona games, named after <a href="https://github.com/TGEnigma">TGEnigma</a>'s all-in-one editor application <a href="https://amicitia.github.io/post/amicitia">of the same name</a>.
                                    </td>
                                    <td id="site_disclaimer" width="5%" style="vertical-align:top;"></td>
                                    <td>
                                        We are NOT affiliated, associated, authorized, endorsed by, or in any way
                                        officially connected with ATLUS, SEGA, or any of its subsidiaries or its affiliates.
                                        The official ATLUS website can be found at <a href="https://atlus.com/">https://atlus.com</a>. ATLUS and SEGA are
                                        registered in the U.S. Patent and Trademark Office. ATLUS and PERSONA are
                                        either registered trademarks or trademarks of ATLUS Co., Ltd. or its affiliates.
                                        <!--Theme Select required for bubbles.js themeing-->
                                        <table id="settings">
                                            <tr>
                                                <td style="vertical-align:top;">
                                                    <br><br>Theme: <select id="theme" name="theme" onchange="ThemeToggle()">
                                                        <option value="" selected>Default</option>
                                                        <option value="p5">Red/Black</option>
                                                        <option value="p4">Yellow/Orange</option>
                                                        <option value="p3fes">Green/Black</option>
                                                        <option value="pq">Pink/Purple</option>
                                                        <option value="custom">Custom</option>
                                                    </select>

                                                    <!--Color Picker-->
                                                    <script>
                                                        jscolor.presets.default = {
                                                            format: 'rgb', previewSize: 20, paletteCols: 1,
                                                            backgroundColor: 'rgb(var(--post))', borderColor: 'rgb(var(--post))',
                                                            padding: 5, width: 100, height: 100, mode: 'HVS',
                                                            controlBorderColor: 'rgb(var(--post))', sliderSize: 8, shadow: false
                                                        };
                                                    </script>
                                                    <div id="colorpicker" style="display:none;">
                                                        <div class="text">
                                                            <div class="toggle-title" style="cursor: pointer;" onclick="updateColorPicker()">
                                                                <a><i class="fa fa-gears"></i> Theme Settings</a>
                                                            </div>
                                                            <div class="toggle-inner" style="display:none;">
                                                                <br><button id="customlink" data-jscolor="{onChange: 'updateLink(this)',value:'rgb(var(--link))', alpha:1}">Link</button>
                                                                <br><button id="customhover" data-jscolor="{onChange: 'updateHover(this)',value:'rgb(var(--hover))', alpha:1}">Hover</button>
                                                                <br><button id="custombg" data-jscolor="{onChange: 'updateBg(this)',value:'rgb(var(--bg))', alpha:1}">Background</button>
                                                                <br><button id="custombg2" data-jscolor="{onChange: 'updateBg2(this)',value:'rgb(var(--bg2))', alpha:1}">Background 2</button>
                                                                <br><button id="customtext" data-jscolor="{onChange: 'updateText(this)',value:'rgb(var(--text))', alpha:1}">Text</button>
                                                                <br><button id="custompost" data-jscolor="{onChange: 'updatePost(this)',value:'rgb(var(--post))', alpha:1}">Post</button>
                                                                <br><button id="customtextinner" data-jscolor="{onChange: 'updateTextinner(this)',value:'rgb(var(--textinner))', alpha:1}">Inner Text</button>
                                                                <br><button id="customfooter" data-jscolor="{onChange: 'updateFooter(this)',value:'rgb(var(--footer))', alpha:1}">Footer</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:top;">
                                                    <!--Bubble Popping SFX Toggle-->
                                                    <br>Sound: <i id="sound" class="fas fa-volume-mute" onclick="SoundToggle()"></i>
                                                    <!--Performance Mode Toggle-->
                                                    <br>Performance Mode: <i id="performance" class="fas fa-toggle-off" onclick="PerformanceToggle()"></i>
                                                    <!--Score Display-->
                                                    <br><span id="score">0</span> bubbles popped
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                            </tbody>
                        </table>
                        <br>
                        <center>
                            <!--AdSense-->
                            <br>
                            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-hx+4+s-4m+70" data-ad-client="ca-pub-9519592525056753" data-ad-slot="8263745709"></ins>
                            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                            <br>
                            <!--Credits-->
                            <br>© ShrineFox 2020 - 2021. <a href="https://ko-fi.com/shrinefox"><i class="fa fa-coffee"></i> Support</a>
                            <br><br>
                            <!--Placeholder-->
                            <select id="game" name="game" style="display:none;">
                                <option value="" selected>Default</option>
                            </select>
                        </center>
                        <!--End Footer-->
                    </footer>
                </div>
                <!--End Bottom-->
		     </div>
		</form>
	</body>
</html>