<!doctype html>
<html>
<head>
    <link rel='shortcut icon' href='images/favicon.png' type='image/x-icon' />
    <meta charset="utf-8">
    <title>Amicitia - Flowscript</title>
    <link href="../css/waves.css" rel="stylesheet" type="text/css">
    <link href="../css/index.css" rel="stylesheet" type="text/css">
    <link href="../css/sidebar.css" rel="stylesheet" type="text/css">
    <link href="../css/select.css" rel="stylesheet" type="text/css">
    <link href="../css/amicitia.css" rel="stylesheet" type="text/css">
    <script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
    <script src="https://shrinefox.com/Scripts/Amicitia/jquery-3.3.1.min.js"></script>
    <script src="../js/bubbles.js"></script>
    <script src="../js/showhide.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="copied">Cheat copied to clipboard!</div>
    <!--Sidebar Toggle-->
    <input type="checkbox" class="openSidebarMenu" id="openSidebarMenu">
    <label for="openSidebarMenu" class="sidebarIconToggle">
        <div class="spinner diagonal part-1"></div>
        <div class="spinner horizontal"></div>
        <div class="spinner diagonal part-2"></div>
    </label>
    <!--Sidebar Menu-->
    <div id="sidebarMenu">
        <ul class="sidebarMenuInner">
            <p style="color:#FFFFFF7F;padding-left:14px;">Amicitia Network</p>
            <li class="active"><a href="https://amicitia.github.io/"><i class="fa fa-desktop"></i> amicitia.github.io</a></li>
            <li><a href="https://shrinefox.com/forum"><i class="fa fa-comments-o"></i> Forum</a></li>
            <li><a href="https://shrinefox.com/guides/"><i class="fa fa-graduation-cap"></i> Guides</a></li>
            <li><a href="https://amicitia.miraheze.org/wiki/Main_Page"><i class="fa fa-users"></i> Wiki</a></li>
            <li><a href="https://amicitia-team.tumblr.com/"><i class="fa fa-newspaper"></i> News</a></li>
            <li><a href="https://shrinefox.com/forum/app.php/faqpage"><i class="fa fa-question-circle"></i> FAQs</a></li>
            <p style="color:#FFFFFF7F;padding-left:14px;margin-bottom: 0px;">Apps</p>
            <li><a href="https://shrinefox.com/textsearch"><i class="fa fa-search"></i> Text Search</a></li>
            <li><a href="https://amicitia.github.io/docs/flowscript"><i class="fa fa-file-code"></i> Flowscript Docs</a></li>
            <li><a href="https://amicitia.github.io/files"><i class="fa fa-folder-open"></i> Files</a></li>
            <li><a href="https://shrinefox.com/PatchCreator"><i class="fa fa-check-square"></i> Patch.yml Creator</a></li>
        </ul>
    </div>
    <!--Header-->
    <div class="header">
        <canvas id="bgCanvas"></canvas>
        <!--Logo and Header Text-->
        <div>
            <center>
                <table>
                    <tr>
                        <td style="text-align:right;">
                            <div class="logo"><img src="https://amicitia.github.io/images/logo.svg"></div>
                        </td>
                        <td>
                            <h1>amicitia.github.io</h1>
                            <h2>flowscript documentation</h2>
                        </td>
                    </tr>
                </table>
            </center>
        </div>
        <!--Waves-->
        <div>
            <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                 viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
                <defs>
                    <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
                </defs>
                <g class="parallax">
                    <use xlink:href="#gentle-wave" x="48" y="0" fill="rgba(17,17,17,0.33)" />
                    <use xlink:href="#gentle-wave" x="48" y="3" fill="rgba(17,17,17,0.6)" />
                    <use xlink:href="#gentle-wave" x="48" y="5" fill="rgba(17,17,17,0.6)" />
                    <use xlink:href="#gentle-wave" x="48" y="7" fill="rgba(17,17,17,1)" />
                </g>
            </svg>
        </div>
        <!--Waves End-->
    </div>
    <!--Header End--></div>
    <div class="content">
        <table>
            <tbody>
                <tr>
                    <td width="25%" style="vertical-align:top"><div class="container body-content">
	<table>
        <tr>
            <td width="25%" style="vertical-align:top">
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td width="75%">
				<div class="content-outer">
                    <div class="content">
					<h1>Hooking Functions</h1>
AtlusScriptCompiler is not perfect, and sometimes decompiled data is imprecise (usually float values). This can lead to glitches (weird camera/player positioning and movement) and even crashes in-game when a recompiled script is modded back in.
<br />To get around this, AtlusScriptCompiler has a feature that preserves the original .BF's data, appending only new data to the end from your compiled .FLOW.
<br />You can use this to <b>replace the contents of a specific method or function</b> without screwing up the rest of the file.
<h2>Creating the .FLOW</h2>
In this example, let's say we wanted to replace ONLY the contents of <b>fld_square_menu</b>, a method in <b>field.bf</b>.
<br />We would have to create a new text document ending with the .FLOW extension, named anything we want. In this example, <b>fieldhook.flow</b>.
<h2>Referencing the .BF</h2>
In that blank document, let's import the bf. Make sure the .flow is in the same directory as the .bf and <a href="https://amicitia.github.io/docs/importing">follow the instructions from the importing guide</a>, like so:
<pre><code>import( "field.bf" );</code></pre>
<h2>Creating the Hook</h2>
Next, let's copy the method we want to replace from the decompiled .bf, changing whatever we want. You can even reference external methods you add to your .flow like so:
<pre><code>
import( "field.bf" );

void fld_square_menu_hook()
{
    ModMenuDisplay();
}

void ModMenuDisplay()
{
    ALL_ENABLE_SHARE_PLAY(); //Re-enables screen recording
    BIT_OFF( 4099 ); //Removes your "tired" status
...
</code></pre>
Note that the replacement method has "_hook" appended to the name. This is important.
<h2>Compiling the .FLOW</h2>
Follow the same steps as the <a href="https://amicitia.github.io/docs/compiling">Compiling guide</a>, except add one extra commandline argument: "-Hook".
<br />For example:
<br /><pre><code>AtlusScriptCompiler.exe fieldhook.flow -Compile -OutFormat V3BE -Library P5 -Encoding P5 -Hook</code></pre>
<br />This should generate fieldhook.bf, an identical copy of field.bf except with the <b>ModMenuDisplay()</b> method replacing the contents of <b>fld_square_menu_hook</b>.
					</div>
				</div>
			</td>
		</tr>
	</table>
</div>            </td>
        </tr>
    </tbody>
</table>