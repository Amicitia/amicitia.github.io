<!doctype html>
<html>
<head>
    <link rel='shortcut icon' href='favicon.png' type='image/x-icon' />
    <meta charset="utf-8">
    <title>Amicitia - Decompiling</title>
    <script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
    <script src="https://amicitia.github.io/js/jquery-3.3.1.min.js"></script>
	<link href="../css/index.css" rel="stylesheet" type="text/css">
    <link href="../css/waves.css" rel="stylesheet" type="text/css">
    <script src="../js/bubbles.js"></script>
    <script src="../js/showhide.js"></script>
    <script src="../js/navigation.js"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=News+Cycle|Open+Sans">
</head>
<body>
    <canvas id='bgCanvas'></canvas>
    <div class="ocean">
        <div class="wave"></div>
        <div class="wave"></div>
    </div>

    <div class="navigation" style="text-align:center;">
        <ul class="main-navigation" style="display:inline-table;">
            <li style="display:inline;"><a href="#!"><img src="../images/amicitia.svg" width="20" height="20"> Mods</a> </li>
            <li style="display:inline;"><a href="http://amicitia-team.tumblr.com"><i class="fas fa-newspaper"></i> News</a> </li>
            <li style="display:inline;"><a href="https://shrinefox.com/guides/"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Guides</a> </li>
            <li style="display:inline;"><a href="https://shrinefox.com/forum/"><i class="fa fa-comment" aria-hidden="true"></i> Forum</a> </li>
            <li style="display:inline;"><a href="https://amicitia.miraheze.org/wiki/Main_Page"><i class="fa fa-users" aria-hidden="true"></i> Wiki</a> </li>
            <li style="display:inline;">
                <a href="#"><i class="fa fa-toolbox"></i> Toolbox</a>
                <ul>
                    <li><a href="https://shrinefox.com/textsearch"><i class="fa fa-search"></i> Dialog Search</a></li>
                    <li><a href="https://amicitia.github.io/docs/flowscript"><i class="fa fa-file-code"></i> Flowscript Docs</a></li>
                    <li><a href="https://amicitia.github.io/files"><i class="fa fa-folder-open"></i> Files</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="logo">
        <center>
            <a href="https://amicitia.github.io/">
                <img src="../images/logo.svg" width="179" height="179">
            </a>
        </center>
    </div>
    <div class="navbar2"><a href="https://shrinefox.com/"><i class="fa fa-home"></i> Home</a> &#9658; <a href="https://amicitia.github.io/">Amicitia</a> &#9658; <a href="https://amicitia.github.io/docs/flowscript"></a>Flowscript &#9658; Decompiling</div>
<div class="container body-content">
	<table>
        <tr>
            <td width="25%" style="vertical-align:top">
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td width="75%">
				<div class="content-outer">
                    <div class="content">
						<h1>Decompiling</h1><br>Using <b>AtlusScriptCompiler</b>, you can turn <b>.bf</b> files into <b>.flow</b> files, or <b>.bmd</b> files into <b>.msg</b> files. Any .bmd contained in a .bf will also be automatically decompiled and output as a .msg file.
<br /><br />You can <a href="https://shrinefox.com?tool=atlusscriptcompiler">download the latest AtlusScriptCompiler here</a>.
<h2>Using Commandline Arguments</h2>
Once you have extracted the program to a folder, simply clicking on the exe causes a console window to quickly open and close. That's normal.
<br />Normally, to use AtlusScriptCompiler you have to use <i>commandline arguments</i>. If you have never used the Windows command prompt before, don't worry. It's quite simple:
<br />You can open the command prompt one of several ways:
<ul>
    <li>Searching for <b>"cmd"</b> in the Windows search bar</li>
    <li>Pressing <b>ctrl + R</b> and typing "cmd" in the Run window</li>
    <li>Typing "cmd" in the address bar in Windows explorer</li>
    <li>Right click inside a folder in Windows Explorer while holding shift and choose "Open Command Window here" (might have to <a href="https://www.windowscentral.com/add-open-command-window-here-back-context-menu-windows-10">do this first on Windows 10</a>)</li>
</ul>
Once the command prompt has opened, all you have to do is type the path to the EXE (i.e. "C:\User\Username\Desktop\AtlusScriptCompiler\AtlusScriptCompiler.exe"). It's smart to wrap the path in quotation marks in case it contains spaces.
<br />Note that you can also drag the EXE onto the command prompt window to automatically fill in the path.
<br />If you used one of the latter two methods of opening the command prompt, if the folder contains AtlusScriptCompiler.exe, all you have to type is "AtlusScriptCompiler.exe".
<br />Press enter, and the program will print information to the console without immediately closing.
<br />You can press up on the keyboard to copy what you previously typed in order to make changes.
<br />
<h3>Supplying the Input File</h3>
Whether the file you want to decompile is a .bf or .bmd, if you supply the path immediately after "AtlusScriptCompiler.exe" (followed by a space) it will be used as the input file.
<br>If your input is a .flow or .msg, you may be looking for <a href="https://amicitia.github.io/docs/compiling">instructions on compiling</a> instead.
<h3>Supplying the Decompile Command</h3>
Follow up the command so far with another space and then "-Decompile" in order to tell the program what to do with the input file.
<h3>Supplying the Library</h3>
You can skip this step if you're decompiling a BMD. For AtlusScriptCompiler to successfully resolve <b>.bf</b> to <b>.flow</b>, a library must exist that defines the game's functions and their parameters. In order to create a library, function signatures must be dumped from the game using <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/master/Scripts/ScriptInterpreterCOMMTableToJson_SMT.py"></a>a script like this one</a>.
<ul>
    <li>"-Library P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Library P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Library P4G" (if your game is <b>Persona 4 Golden</b>)</li>
    <li>"-Library P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Library P3F" (if your game is <b>Persona 3 FES</b>)</li>
    <li>"-Library PQ2" (if your game is <b>Persona Q2</b>)</li>
    <li>"-Library SMT3" (if your game is <b>SMT Nocturne</b>)</li>
    <li>"-Library DDS" (if your game is <b>Digital Devil Saga</b>)</li>
</ul>
<br />The script will fail to decompile if the appropriate library isn't present.
<br />At the time of writing, there is no library for <b>Persona 3 Portable</b>.
<h3>Supplying the Encoding</h3>
For AtlusScriptCompiler to successfully decompile to either <b>.flow</b> or <b>.msg</b>, encoding must be specified.
<ul>
    <li>"-Encoding P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Encoding P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Encoding P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Encoding SJ" (if your game is <b>Persona Q(2)</b> or uses Shift-JIS/CP932)</li>
</ul>
<h3>Specifying the Output File</h3>
While the command so far is enough to output a file, it would be automatically named after the input. For instance, field.bmd would generate field.bmd.msg.
<br />If you would rather name it something else like field2.msg, or replace field.msg, try something like the following:
<br /><pre><code>"AtlusScriptCompiler.exe" "input.bmd" -Decompile -Encoding P5 -Out "input.msg"
</code></pre>
<br />Once again, remember to wrap paths to files in quotation marks in case they contain spaces.
<h2>Using the GUI Frontend</h2>
There is an unofficial GUI for AtlusScriptCompiler that allows you to simply drag and drop files to compile or decompile them.
<br />You can get it from <a href="https://github.com/ShrineFox/AtlusScriptCompiler-GUI-Frontend/releases">here</a>. Just extract the contents of the .zip to the folder containing AtlusScriptCompiler.exe on your computer and run it.
<br />Be sure to set the proper game in the dropdown first. If no output file is produced, check the "AtlusScriptCompiler.log" file in the same directory.
<h2>Resolving Errors</h2>
If a script has failed to decompile, an error message should be shown. It will usually display a description of what's wrong.
<br />For a more visual guide on using AtlusScriptCompiler, see the video:
<br /><iframe width="560" height="315" src="https://www.youtube.com/embed/HonHDoSJNDY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
					</div>
				</div>
			</td>
		</tr>
	</table>
</div>

<p style="font-size: 12px;line-height: 0.9;text-align:right;padding-right:10px;color:#fff;">We are not affiliated, associated, authorized, endorsed by, or in any way 
    <br>officially connected with ATLUS, SEGA, or any of its subsidiaries or its affiliates.
    <br>The official ATLUS website can be found at https://atlus.com. "Persona", as well
    <br>as all characters referenced on this page are registered trademarks of ATLUS.</p>

<div class="footer">© ShrineFox 2020. Last updated 6/7/2020.</div>