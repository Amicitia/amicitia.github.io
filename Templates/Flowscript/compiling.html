
                <div class="content-outer">
                    <div class="content"><br>
						Basics
						<br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
						<br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
						<br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
						<br>
						<br>Features
						<br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
						<br>↳ Declaring Functions
						<br>↳ Declaring Variables
						<br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
						<br>
						<br>P5 Functions
						<br>↳ AI
						<br>↳ Common
						<br>↳ Facility
						<br>↳ Field
						<br>↳ Net
						<br>↳ Social
					</div>
				</div>
			</td>
			<td style="width: 75%; padding-right:20px; vertical-align: top;">
				<div class="content-outer">
                    <div class="content">
						<h1>Compiling</h1>
<br>Using <b>AtlusScriptCompiler</b>, you can turn <b>.flow</b> files into <b>.bf</b> files, or <b>.msg</b> files into <b>.bmd</b> files. Anything else referenced in a .flow (bf/bmd/flow/msg) also becomes part of a resulting .bf file.
<br />
<br />You can <a href="https://shrinefox.com?tool=atlusscriptcompiler">download the latest AtlusScriptCompiler here</a>.
<h2>Using Commandline Arguments</h2>
Once you have extracted the program to a folder, simply clicking on the exe causes a console window to quickly open and close. That's normal.
<br />Normally, to use AtlusScriptCompiler you have to use <i>commandline arguments</i>. If you have never used the Windows command prompt before, don't worry. It's quite simple:
<br />You can open the command prompt one of several ways:
<ul>
    <li>Searching for <b>"cmd"</b> in the Windows search bar</li>
    <li>Pressing <b>ctrl + R</b> and typing "cmd" in the Run window</li>
    <li>Typing "cmd" in the address bar in Windows explorer</li>
    <li>Right click inside a folder in Windows Explorer while holding shift and choose "Open Command Window here" (might have to <a href="https://www.windowscentral.com/add-open-command-window-here-back-context-menu-windows-10">do this first on Windows 10</a>)</li>
</ul>
Once the command prompt has opened, all you have to do is type the path to the EXE (i.e. "C:\User\Username\Desktop\AtlusScriptCompiler\AtlusScriptCompiler.exe"). It's smart to wrap the path in quotation marks in case it contains spaces.
<br />Note that you can also drag the EXE onto the command prompt window to automatically fill in the path.
<br />If you used one of the latter two methods of opening the command prompt, if the folder contains AtlusScriptCompiler.exe, all you have to type is "AtlusScriptCompiler.exe".
<br />Press enter, and the program will print information to the console without immediately closing.
<br />You can press up on the keyboard to copy what you previously typed in order to make changes.
<br />
<h3>Supplying the Input File</h3>
Whether the file you want to compile is a .msg or .flow, if you supply the path immediately after "AtlusScriptCompiler.exe" (followed by a space) it will be used as the input file.
<br>If your input is a .bf or .bmd, you may be looking for <a href="https://amicitia.github.io/docs/decompiling">instructions on <i>de</i>compiling</a> instead.
<h3>Supplying the Compile Command</h3>
Follow up the command so far with another space and then "-Compile" in order to tell the program what to do with the input file.
<h3>Supplying the Output Format</h3>
Once again, separate this next part from the previous with a space and type one of the following:
<ul>
    <li>"-OutFormat V3BE" (if your game is <b>Persona 5</b> and your desired output format is <b>.BF</b>, ideal when <b>.FLOW</b> is supplied as the input)</li>
    <li>"-OutFormat V1BE" (if your game is <b>Persona 5 (PS3)</b> and your desired output format is <b>.BMD</b>, ideal when <b>.MSG</b> is supplied as the input)</li>
    <li>"-OutFormat V1" (if your game is <b>Persona 5 (PS4) or Persona 3 or 4</b> and your desired output format is <b>.BMD</b>, ideal when <b>.MSG</b> is supplied as the input)</li>
    <li>"-OutFormat V1" (if your game is <b>Persona 3 or 4</b> and your desired output format is <b>.BF</b>, ideal when <b>.FLOW</b> is supplied as the input)</li>
</ul>
<br />For example so far, your command should look something like this:
<pre><code>"AtlusScriptCompiler.exe" "field.bf.flow" -Compile -OutFormat V3BE</code></pre>
<h3>Supplying the Library</h3>
For AtlusScriptCompiler to successfully resolve <b>.flow</b> to <b>.bf</b>, a library must exist that defines the game's functions and their parameters. In order to create a library, function signatures must be dumped from the game using <a href="https://github.com/TGEnigma/AtlusScriptToolchain/blob/master/Scripts/ScriptInterpreterCOMMTableToJson_SMT.py"></a>a script like this one</a>.
<ul>
    <li>"-Library P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Library P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Library P4G" (if your game is <b>Persona 4 Golden</b>)</li>
    <li>"-Library P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Library P3F" (if your game is <b>Persona 3 FES</b>)</li>
    <li>"-Library PQ2" (if your game is <b>Persona Q2</b>)</li>
    <li>"-Library SMT3" (if your game is <b>SMT Nocturne</b>)</li>
    <li>"-Library DDS" (if your game is <b>Digital Devil Saga</b>)</li>
</ul>
<br />The script will fail to compile if the appropriate library isn't present.
<br />At the time of writing, there is no library for <b>Persona 3 Portable</b>.
<h3>Supplying the Encoding</h3>
For AtlusScriptCompiler to successfully compile to either <b>.bf</b> or <b>.bmd</b>, encoding must be specified.
<ul>
    <li>"-Encoding P5" (if your game is <b>Persona 5</b>)</li>
    <li>"-Encoding P4" (if your game is <b>Persona 4</b>)</li>
    <li>"-Encoding P3" (if your game is <b>Persona 3</b>)</li>
    <li>"-Encoding SJ" (if your game is <b>Persona Q(2)</b> or uses Shift-JIS/CP932)</li>
</ul>
<h3>Specifying the Output File</h3>
While the command so far is enough to output a file, it would be automatically named after the input. For instance, field.bf.flow would generate field.bf.flow.bf.
<br />If you would rather name it something else like field2.bf, or replace field.bf, try something like the following:
<br /><pre><code>"AtlusScriptCompiler.exe" "field.bf.flow" -Compile -OutFormat V3BE -Library P5 -Encoding P5 -Out "field.bf"</code></pre>
<br />Once again, remember to wrap paths to files in quotation marks in case they contain spaces.
<h3>Other Commands</h3>
When you run the program without specifying any commandline arguments, you will be shown a list of additional commands to use.
<br />For information on how to use the "-Hook" command, <a href="https://amicitia.github.io/docs/hookingfunctions">see this page</a>.
<h2>Using the GUI Frontend</h2>
There is an unofficial GUI for AtlusScriptCompiler that allows you to simply drag and drop files to compile or decompile them.
<br />You can get it from <a href="https://github.com/ShrineFox/AtlusScriptCompiler-GUI-Frontend/releases">here</a>. Just extract the contents of the .zip to the folder containing AtlusScriptCompiler.exe on your computer and run it.
<br />Be sure to set the proper game in the dropdown first. If no output file is produced, check the "AtlusScriptCompiler.log" file in the same directory.
<h2>Resolving Errors</h2>
If a script has failed to compile, an error message should be shown. It will usually try to show the exact line number where the error occured so you can fix it, along with a description of what's wrong.
<br />For a more visual guide on using AtlusScriptCompiler, see the video:
<br /><iframe width="560" height="315" src="https://www.youtube.com/embed/HonHDoSJNDY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>